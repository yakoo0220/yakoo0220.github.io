---
layout:     post                    # 使用的布局（不需要改）
title:      使用MDT部署Windows 10映像               # 标题 
subtitle:   MDT入门          #副标题
date:       2020-05-24              # 时间
author:     Yakoo                      # 作者
header-img: img/post-bg-2015.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - Windows
    - MDT
    - Microsoft
---

# MDT入门
>对Windows的批量，标准化的部署是必须的。对离职员工收回的机器进行重新擦除并重新部署，即便是新购买的电脑自带系统，一般也会擦掉重新部署，为员工提供一个统一，合规可控可管理的桌面系统。

对于MDT的介绍内容不在抄过来凑字数了，参考[微软文档](https://docs.microsoft.com/zh-cn/windows/deployment/deploy-windows-mdt/get-started-with-the-microsoft-deployment-toolkit)。

对于百度上和其他博客的一些操作方法个人一般用作参考或补充，主要还是以官方的文档为准，以确保安全和准确，还有全面性。

## 准备MDT基础结构
你需要准备一个域环境，一台域控，用于该域的DNS服务器以及DHCP服务器，MDT需要WDS，当然WSUS也一起部署是可以的。官网文档是分开部署的，评估环境我把他们部署在一起，尚未发现有出现问题。

服务器与客户端的网络需要联通，需要DNS能解析各机器的AD信息以便读取共享。

对于MDT，需要客户端系统对应的ADK，PE和系统映像管理器更新包。

安装WDS和WSUS，安装MDT。

需要创建一个MDT服务账户，用与客户端在PE环境下连接到MDT。

如果需要记录日志，需要创建一个日志文件夹并给服务账户赋予权限。

## 使用MDT部署Windows映像
映像推荐在虚拟环境中生成，以排除一些硬件的问题，并且可以提高效率。

启动deploymentworkbench，创建一个新的部署共享，设置文件夹名称和共享名称。实验一下是否可以通过UNC访问到，并给服务账户赋予共享权限。

如果需要监视，则在属性中启用监视。

在操作系统中，添加一个标准的完整的Windows10映像。
在应用程序中，添加一些应用程序，应当注意这些应用程序被应用的体系结构并在命名中加以区分。
应确定这些应用程序的运行参数，测试环境中配置了一个Chrome浏览器，无需应答的msi包。

就绪后，对于这个完整的映像生成一个新的任务序列。
编辑这个任务序列，添加一些软件的安装。

右键共享，在属性中有规则编辑，对应共享文件夹内Control文件夹中的内容，Bootstrap定义了共享文件夹的UNC，和服务账户的内容，而CustomSettings定义了加域，更新，设置时区，设置计算机名，产品KEY，选择软件等内容。

你还可能需要添加一些必要的驱动程序，以便在物理机上真正部署的时候安装这些驱动。

你还可能需要一个专门用于拉新机器加域的账户，或者使用原本有权限的账户亦可。

当这些内容设置完成，生成MDT的启动映像。

可以利用启动映像去捕获自定义映像并应用于部署，可以预先把一些组件安装在自定义映像中。

把MDT的启动映像添加到WDS中，监听所有请求，客户端通过网卡启动，即可部署。

需要注意的是，客户端应当可以取得IP地址，能与域控通信认证MDT的服务账户，能读取到部署共享的内容，服务账户的共享权限应当配置正确。